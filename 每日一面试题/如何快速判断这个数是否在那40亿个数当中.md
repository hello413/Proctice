## 如何快速判断这个数是否在那40亿个数当中？ 

**问题描述**

​	有40亿个用户的id,查找哪些id是重复的

---

**思路**：

 1. 利用Set(知道其缺点就行，面试不敢这样)

    > A：用一个Set来存储这些数，新来的数判断是否在Set里
    >
    > B：如果整数是32位的，那么你的Set就需要多少字节？
    >
    > A：一个整数4个字节，40亿个的话，应该是160亿个字节，大概16GB
    >
    > B：如果我的电脑有2G内存，但是需要尽可能快的得出答案
    >
    > A:  分8次？
    >
    > B：这样比较慢，这样吧，我给你一批电脑(我已经提到分布式这步了，再答不上来就走吧)
    >
    > A：emmm
    >
    > B：好了，这道题就到这儿吧

    用Set？ 从磁盘加载数据是磁盘IO操作，是非常慢的，你每次都要加载这么大的数据，还要8次，我估计你找一个数的时间可以达到分钟甚至小时级了。  B说给你一批机器，就是暗示A可以用分布式算法。你把数据分散在8台机器上，然后来一个新的数据，8台机器一起找，最后再汇总结果就行了 

 2. **bitmap（位图法）**   用位来表示状态，从而节省空间 

​		 32位int的范围，总共就是2的32次方，大概42亿多点。所以你可以申请2的32次方个位。 

![1589033425583](.\Images\1589033425583.png)

优点： 2的32次方个位，相当于2的29次方个字节，哇，才500MB，真是节省了不少内存呢 

 3. 昊天锤

    首先，32位int的范围是42亿，40亿整数中肯定有一些是连续的，我们可以先对数据进行一个外部排序，然后用一个初始的数和一个长度构成一个数据结构，来表示一段连续的数，举个例子。

    如果数据是1 2 3 4 6 7……这种的，那么可以用(1,4)和(6,2)来表示，这样一来，连续的数都变成了2个数表示。来了一个新数之后，就用二分法进行查找了。

    这样一来，最差情况就是2亿多的断点，也就是2亿多的结构体，每个结构体8个字节，大概16亿字节，1.6GB